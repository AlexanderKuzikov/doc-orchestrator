# Glossary — DocOrchestrator

Краткий словарь терминов, используемых в проекте DocOrchestrator: от пайплайна обработки документов до настроек локального инференса (LM Studio / GGUF).

## Термины проекта

**DocOrchestrator** — config-first оркестратор обработки документов: вход (PDF/сканы) → артефакты → тип документа → извлечение полей → валидация/верификация → отчёты.

**Пайплайн (pipeline)** — последовательность стадий обработки (атомов), которые выполняются по маршруту и могут включаться/выключаться конфигом.

**Атом / стадия (stage)** — изолированный шаг пайплайна (например, rasterize/classify/extract/evaluate) с чётким контрактом по входным/выходным артефактам.

**Короткий маршрут** — упрощённый режим разработки: растрирование → извлечение → добавление docTypes (без сегментации/split и без сложной предобработки).

**root.json** — корневой конфиг, управляющий маршрутом, путями, включением стадий, моделями и профилями запуска.

**docTypes/*.json** — конфиги типов документов (паспорт, ЕГРЮЛ и т.д.): признаки, список полей, схемы, параметры извлечения и валидации.

**staging/** — рабочая зона, где хранятся артефакты обработки (растры страниц, кропы, промежуточные JSON) для переиспользования при перезапусках.

**Артефакт (artifact)** — файл/JSON, который является результатом стадии и используется следующими стадиями (например, pages/r150/*.webp, document.json).

**manifest.json** — «паспорт» обработки: что сделано, какими версиями конфигов/моделей, где лежат артефакты, плюс метрики (время, точность, ошибки).

**Профилирование (timing/profiling)** — замер времени на всех стадиях (включая растрирование), чтобы находить узкие места и сравнивать режимы обработки.

## Документы и изображения

**Растрирование (rasterize)** — преобразование PDF-страниц (вектор/текст/скан) в изображения фиксированного разрешения для подачи в VLM и дальнейшей обработки.

**DPI (dots per inch)** — разрешение рендера при растрировании PDF; влияет на размер изображения и читаемость мелкого текста.

**Пирамида DPI** — сохранение нескольких разрешений одной и той же страницы (например 100/150/200/250/300 DPI) ради ускорения и А/Б-тестов точности.

**WebP (lossless)** — формат изображения, который удобно хранить как артефакт: компактнее PNG при сохранении качества.

**bbox (bounding box)** — прямоугольник (обычно `[x1, y1, x2, y2]`) в координатах изображения, задающий область документа/поля/фрагмента для нарезки (crop).

**splitter / Segmenter** — стадия обнаружения нескольких документов на одном листе и нарезки на отдельные изображения по bbox.

**Предобработка (preprocess/enhance)** — улучшение изображения перед извлечением (deskew, контраст, шумоподавление, и т.п.), выполняемое на CPU как дешёвый способ поднять точность.

## Модели и извлечение

**VLM (Vision-Language Model)** — модель, принимающая изображение и текстовую инструкцию (промпт) и выдающая ответ (в идеале — структурированный JSON).

**Router (быстрая модель, например 2B)** — стадия быстрого определения типа документа и первичной оценки (например, «ксёро-скан или нет»).

**Extractor (старая модель, например SAGE/8B)** — стадия извлечения целевых полей в JSON по типу документа.

**Промпт (prompt)** — текстовая инструкция модели, которая фиксирует формат ответа (JSON-only), список полей и правила извлечения.

**JSON-only** — требование к модели возвращать только JSON без пояснений, чтобы результат был детерминировано парсабельным.

**Retry prompt** — повторный запрос к модели при провале валидации: короткая инструкция «исправь только эти поля/ошибки, JSON-only».

## Качество и метрики

**Валидация (validation)** — проверка формата/типа/обязательности полей (часто через JSON Schema и регулярки).

**Нормализация (normalization)** — приведение значений к каноническому виду (даты, пробелы, регистр, типографика, единый формат).

**Верификация (verification)** — доменные проверки и согласованность (контрольные суммы, диапазоны, взаимосвязи полей).
