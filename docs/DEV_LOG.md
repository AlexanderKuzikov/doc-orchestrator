\# Development Log: DocOrchestrator



\## 2025-12-19: Запуск и архитектурный фундамент



\### Контекст дня

\- Начало работы над проектом. Переход от идеи к работающему прототипу.

\- Решение технических проблем с растрированием на Windows (отказ от Ghostscript/Canvas в пользу NAPI-RS и WASM).

\- Успешная интеграция с LM Studio.



\### Ключевые достижения

1\. \*\*Ingestor \& Rasterizer\*\*: 

&nbsp;  - Реализована бесшовная обработка PDF и папок-контейнеров. 

&nbsp;  - Решена проблема отрисовки кириллических шрифтов (Tahoma) через `standardFontDataUrl` и `disableFontFace`.

&nbsp;  - Выбран формат \*\*WebP\*\* (lossless для 300dpi) как оптимальный по весу и качеству для VLM.

2\. \*\*VLM Connection\*\*:

&nbsp;  - Налажен мост с Qwen3-VL 2B. Модель успешно классифицирует паспорт РФ.

&nbsp;  - Отработан формат передачи изображений (Base64 в OpenAI-style API).

3\. \*\*Segmenter/Splitter\*\*:

&nbsp;  - Обнаружена и решена проблема "комбо-сканов" (несколько доков на листе).

&nbsp;  - Тесты Qwen3-VL 4B/8B показали прецизионную точность в определении координат `bbox`.

4\. \*\*Atomic Orchestrator\*\*:

&nbsp;  - Спроектирована структура управления стадиями через `root.json` (enabled/priority).

&nbsp;  - Внедрена идея "Контекст-Артефакт": стадии работают только при необходимости обновления данных.



\### Технические решения и идеи

\- \*\*No Tesseract\*\*: Решено полностью исключить классический OCR. VLM справляются лучше за счет контекстного понимания текста.

\- \*\*Reference Testing\*\*: Добавлен модуль `evaluate`, позволяющий сравнивать вывод ИИ с эталонным JSON для замера % точности.

\- \*\*Hardware Path\*\*: Текущая разработка на GTX 1660 6Gb (модели 2B/4B), целевая платформа — RTX 5060 Ti 16Gb (для SAGE-MM 4B и Qwen3 8B в f16).



\### Планы на завтра

\- Тестирование модели \*\*SAGE-MM-Qwen3-VL-4B-SFT\_RL\*\* (Allen AI) как основного экстрактора.

\- Реализация атомарного модуля `Splitter.js` для нарезки документов.

\- Разбор образцов документов для работы с должниками (ЕГРЮЛ, ЕГРИП, ЕГРН) и описание их полей.



